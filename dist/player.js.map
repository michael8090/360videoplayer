{"version":3,"sources":["webpack:///webpack/bootstrap e4f547d394e7b77cbfc5","webpack:///./src/player.js"],"names":["domFromString","htmlString","parent","document","createElement","innerHTML","firstElementChild","isWebGLSupported","canvas","window","WebGLRenderingContext","getContext","e","Player","module","exports","containerId","view","enableSensorControl","container","getElementById","Error","w","offsetWidth","h","offsetHeight","camera","THREE","PerspectiveCamera","position","x","y","z","scene","Scene","video","body","appendChild","texture","VideoTexture","minFilter","LinearFilter","magFilter","format","RGBFormat","sphere","Mesh","SphereGeometry","MeshBasicMaterial","map","scale","rotateY","Math","PI","add","renderer","WebGLRenderer","CanvasRenderer","setSize","sensorControls","DeviceOrientationController","domElement","connect","enableSensor","animate","addEventListener","onResize","videoUrl","setAttribute","render","update","requestAnimationFrame","aspect","updateProjectionMatrix","enableManualDrag","disableSensor"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;ACtCA;AACA;;AAEA,UAASA,aAAT,CAAuBC,UAAvB,EAAmC;AAC/B,SAAMC,SAASC,SAASC,aAAT,CAAuB,KAAvB,CAAf;AACAF,YAAOG,SAAP,GAAmBJ,UAAnB;AACA,YAAOC,OAAOI,iBAAd;AACH;;AAED,KAAMC,mBAAqB,YAAW;AAClC,SAAI;AACA,aAAIC,SAASL,SAASC,aAAT,CAAwB,QAAxB,CAAb;AACA,gBAAO,CAAC,EAAGK,OAAOC,qBAAP,KAAiCF,OAAOG,UAAP,CAAkB,OAAlB,KAA8BH,OAAOG,UAAP,CAAkB,oBAAlB,CAA/D,CAAH,CAAR;AACH,MAHD,CAGE,OAAMC,CAAN,EAAS;AACP,gBAAO,KAAP;AACH;AACJ,EAPyB,EAA1B;;AAUAH,QAAOI,MAAP,GAAgBC,OAAOC,OAAP;AACZ,uBAAmE;AAAA,0EAAJ,EAAI;;AAAA,aAAtDC,WAAsD,QAAtDA,WAAsD;AAAA,aAAzCC,IAAyC,QAAzCA,IAAyC;AAAA,0CAAnCC,mBAAmC;AAAA,aAAnCA,mBAAmC,yCAAb,KAAa;;AAAA;;AAAA;;AAC/D,aAAMC,YAAYhB,SAASiB,cAAT,CAAwBJ,WAAxB,CAAlB;AACA,aAAI,CAACG,SAAL,EAAgB;AACZ,mBAAM,IAAIE,KAAJ,8BAAqCL,WAArC,CAAN;AACH;;AAED,cAAKG,SAAL,GAAiBA,SAAjB;;AAEA,aAAMG,IAAIH,UAAUI,WAApB;AACA,aAAMC,IAAIL,UAAUM,YAApB;AACA,aAAMC,SAAS,IAAIC,MAAMC,iBAAV,CAA4BX,QAAQ,EAApC,EAAwCK,IAAIE,CAA5C,EAA+C,CAA/C,EAAkD,IAAlD,CAAf;AACAE,gBAAOG,QAAP,CAAgBC,CAAhB,GAAoB,IAApB;AACAJ,gBAAOG,QAAP,CAAgBE,CAAhB,GAAoB,CAApB;AACAL,gBAAOG,QAAP,CAAgBG,CAAhB,GAAoB,IAApB;AACA,cAAKN,MAAL,GAAcA,MAAd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAKO,KAAL,GAAa,IAAIN,MAAMO,KAAV,EAAb;;AAEA,aAAMC,QAAQnC,wNAAd;AAKA,cAAKmC,KAAL,GAAaA,KAAb;AACAhC,kBAASiC,IAAT,CAAcC,WAAd,CAA0BF,KAA1B;;AAEA,aAAMG,UAAU,IAAIX,MAAMY,YAAV,CAAuBJ,KAAvB,CAAhB;AACAG,iBAAQE,SAAR,GAAoBb,MAAMc,YAA1B;AACAH,iBAAQI,SAAR,GAAoBf,MAAMc,YAA1B;AACAH,iBAAQK,MAAR,GAAiBhB,MAAMiB,SAAvB;;AAEA;AACA;;AAEA,aAAMC,SAAS,IAAIlB,MAAMmB,IAAV,CACX,IAAInB,MAAMoB,cAAV,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,GAAnC,CADW,EAEX,IAAIpB,MAAMqB,iBAAV,CAA4B;AACxBC,kBAAKX;AADmB,UAA5B,CAFW,CAAf;;AAOAO,gBAAOK,KAAP,CAAapB,CAAb,GAAiB,CAAC,CAAlB;AACAe,gBAAOM,OAAP,CAAeC,KAAKC,EAAL,GAAU,GAAzB;AACA,cAAKpB,KAAL,CAAWqB,GAAX,CAAeT,MAAf;;AAEA,aAAMU,WAAWhD,mBAAmB,IAAIoB,MAAM6B,aAAV,EAAnB,GAA+C,IAAI7B,MAAM8B,cAAV,EAAhE;AACAF,kBAASG,OAAT,CAAiBvC,UAAUI,WAA3B,EAAwCJ,UAAUM,YAAlD;AACA,cAAK8B,QAAL,GAAgBA,QAAhB;;AAEA,cAAKI,cAAL,GAAsB,IAAIC,2BAAJ,CAAgClC,MAAhC,EAAwC6B,SAASM,UAAjD,CAAtB;AACA,cAAKF,cAAL,CAAoBG,OAApB;AACA,cAAKC,YAAL;;AAEA5C,mBAAUkB,WAAV,CAAsBkB,SAASM,UAA/B;;AAEA,cAAKG,OAAL;;AAEAvD,gBAAOwD,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,QAAvC;AACH;;AAtEW;AAAA;AAAA,qCA0Fa;AAAA,iBAAfC,QAAe,yDAAJ,EAAI;;AACrB,kBAAKhC,KAAL,CAAW7B,iBAAX,CAA6B8D,YAA7B,CAA0C,KAA1C,EAAiDD,QAAjD;AACH;AA5FW;;AAAA;AAAA;AAAA;;AAAA,UAwEZE,MAxEY,GAwEH,YAAM;AACX,eAAKV,cAAL,CAAoBW,MAApB;AACA,eAAKf,QAAL,CAAcc,MAAd,CAAqB,MAAKpC,KAA1B,EAAiC,MAAKP,MAAtC;AACH,MA3EW;;AAAA,UA6EZsC,OA7EY,GA6EF,YAAM;AACZ,eAAKK,MAAL;AACAE,+BAAsB,MAAKP,OAA3B;AACH,MAhFW;;AAAA,UAkFZE,QAlFY,GAkFD,YAAM;AACb,aAAM/C,YAAY,MAAKA,SAAvB;AACA,eAAKO,MAAL,CAAY8C,MAAZ,GAAqBrD,UAAUI,WAAV,GAAwBJ,UAAUM,YAAvD;AACA,eAAKC,MAAL,CAAY+C,sBAAZ;;AAEA,eAAKlB,QAAL,CAAcG,OAAd,CAAsBvC,UAAUI,WAAhC,EAA6CJ,UAAUM,YAAvD;AACH,MAxFW;;AAAA,UA8FZsC,YA9FY,GA8FG,YAAM;AACjB,eAAKJ,cAAL,CAAoBe,gBAApB,GAAuC,KAAvC;AACH,MAhGW;;AAAA,UAkGZC,aAlGY,GAkGI,YAAM;AAClB,eAAKhB,cAAL,CAAoBe,gBAApB,GAAuC,IAAvC;AACH,MApGW;AAAA,UAAhB,C","file":"dist/player.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e4f547d394e7b77cbfc5\n **/","/* global THREE */\n// var OrbitControls = require('three-orbit-controls')(THREE);\n\nfunction domFromString(htmlString) {\n    const parent = document.createElement('div');\n    parent.innerHTML = htmlString;\n    return parent.firstElementChild;\n}\n\nconst isWebGLSupported =  (function (){\n    try {\n        var canvas = document.createElement( 'canvas' );\n        return !! (window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n    } catch(e) {\n        return false;\n    }\n})();\n\n\nwindow.Player = module.exports = class Player {\n    constructor({containerId, view, enableSensorControl = false} = {}) {\n        const container = document.getElementById(containerId);\n        if (!container) {\n            throw new Error(`container is not found: ${containerId}`);\n        }\n\n        this.container = container;\n\n        const w = container.offsetWidth;\n        const h = container.offsetHeight;\n        const camera = new THREE.PerspectiveCamera(view || 75, w / h, 1, 1000);\n        camera.position.x = 0.01;\n        camera.position.y = 0;\n        camera.position.z = 0.01;\n        this.camera = camera;\n\n        // const controls = new OrbitControls(camera);\n        // controls.enablePan = true;\n        // controls.enableZoom = true;\n        // controls.zoomSpeed = 10;\n        // controls.minDistance = -50;\n        // controls.maxDistance = 50;\n        // controls.autoRotate = false;\n        // this.orbitControls = controls;\n        // controls.autoRotateSpeed = speed || 0.5;\n        // controls.addEventListener('change', this.render);\n\n        this.scene = new THREE.Scene();\n\n        const video = domFromString(`\n            <video style=\"display: none;\" autoplay preload=\"auto\" id=\"video\" loop=\"true\" webkit-playsinline crossOrigin=\"anonymous\">\n                <source type=\"video/mp4\">\n            </video>`\n        );\n        this.video = video;\n        document.body.appendChild(video);\n\n        const texture = new THREE.VideoTexture(video);\n        texture.minFilter = THREE.LinearFilter;\n        texture.magFilter = THREE.LinearFilter;\n        texture.format = THREE.RGBFormat;\n\n        // var texture = THREE.ImageUtils.loadTexture(image);\n        // texture.minFilter = THREE.LinearFilter;\n\n        const sphere = new THREE.Mesh(\n            new THREE.SphereGeometry(100, 100, 100),\n            new THREE.MeshBasicMaterial({\n                map: texture\n            })\n        );\n\n        sphere.scale.x = -1;\n        sphere.rotateY(Math.PI * 1.5);\n        this.scene.add(sphere);\n\n        const renderer = isWebGLSupported ? new THREE.WebGLRenderer() : new THREE.CanvasRenderer();\n        renderer.setSize(container.offsetWidth, container.offsetHeight);\n        this.renderer = renderer;\n\n        this.sensorControls = new DeviceOrientationController(camera, renderer.domElement);\n        this.sensorControls.connect();\n        this.enableSensor();\n\n        container.appendChild(renderer.domElement);\n\n        this.animate();\n\n        window.addEventListener('resize', this.onResize);\n    }\n\n    render = () => {\n        this.sensorControls.update();\n        this.renderer.render(this.scene, this.camera);\n    };\n\n    animate = () => {\n        this.render();\n        requestAnimationFrame(this.animate);\n    };\n\n    onResize = () => {\n        const container = this.container;\n        this.camera.aspect = container.offsetWidth / container.offsetHeight;\n        this.camera.updateProjectionMatrix();\n\n        this.renderer.setSize(container.offsetWidth, container.offsetHeight);\n    };\n\n    loadVideo(videoUrl = '') {\n        this.video.firstElementChild.setAttribute('src', videoUrl);\n    };\n\n    enableSensor = () => {\n        this.sensorControls.enableManualDrag = false;\n    };\n\n    disableSensor = () => {\n        this.sensorControls.enableManualDrag = true;\n    };\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/player.js\n **/"],"sourceRoot":""}